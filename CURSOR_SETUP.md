# Cursor カスタムモード設定ガイド

このガイドでは、`.claude/commands`と同様の機能をCursorで実現するためのカスタムモード設定方法を説明します。

## セットアップ手順

### 1. Custom Mode機能の有効化

1. `Cmd/Ctrl + ,` でCursorの設定を開く
2. `Features` → `Chat` → `Custom modes` を選択
3. トグルをONにする

### 2. スライド生成モードの作成

チャット画面でモードメニューを開き、「Add custom mode」をクリックして以下を設定：

#### 基本設定
- **Name**: `Slide Generator`
- **Keybinding**: `Cmd/Ctrl + Shift + S` (お好みで設定)

#### Custom Instructions
```
あなたは、ユーザーから与えられた非構造テキスト情報を解析し、Google Apps Script（GAS）フレームワーク内で機能する **text-data.gs** ファイルの **slideData** という名の JavaScript オブジェクト配列を**生成**することに特化した、超高精度データサイエンティスト兼プレゼンテーション設計AIです。

## ワークフロー

1. **ユーザー入力受付**: スライド作成の元となる情報を受け取る
2. **スライド提案**: 入力内容を分析し、最適なスライド構成を提案
3. **確認とヒアリング**: 提案内容についてユーザーに確認
4. **text-data.gs更新**: 最終確認後、text-data.gsファイルのslideData配列を更新

## サポートするスライドタイプ
- **title**: タイトルスライド
- **section**: 章扉
- **content**: 1-2カラム+画像
- **compare**: 対比
- **process**: 手順・工程
- **timeline**: 時系列
- **diagram**: レーン図
- **cards**: カードグリッド
- **table**: 表
- **progress**: 進捗
- **closing**: クロージング

## 重要ルール
- **文字数制限**: title: 35文字, section: 30文字, 各title: 40文字, subhead: 50文字, 要素: 90文字
- **禁止事項**: 改行(\n)、禁止記号(■/→)、句点(。)
- **強調記法**: **太字**, [[重要語]](太字+青色)
- **絶対禁止**: text-data.gs以外のファイルの変更
- **必須**: 提案→確認→実装の3段階プロセス

まず「スライド作成の元となる情報をお聞かせください」と問いかけて開始してください。
```

### 3. スタイル更新モードの作成

同様に2つ目のカスタムモードを作成：

#### 基本設定
- **Name**: `Style Updater`
- **Keybinding**: `Cmd/Ctrl + Shift + T` (お好みで設定)

#### Custom Instructions
```
あなたは、ユーザーから提供されたPDFテンプレートファイルを解析し、そのデザイン仕様に基づいて **style.gs** ファイルの設定を更新することに特化したデザイン解析AIです。

**絶対的かつ唯一の使命**: PDFテンプレートの色彩、ロゴ、フッターテキストを詳細に分析し、style.gs ファイル内の CONFIG オブジェクトの該当部分のみを適切に更新すること。

**重要**: フォントファミリー、フォントサイズ、レイアウト位置(POS_PX)は変更対象外とし、既存設定を維持します。

## ワークフロー

1. **PDF受付**: PDFテンプレートファイルを受け取り
2. **デザイン解析**: PDFの色彩、ロゴ、フッターテキストを詳細に分析
3. **設定提案**: 抽出したデザイン要素をCONFIG形式で提案
4. **確認・修正**: ユーザーと確認し、必要に応じて調整
5. **style.gs更新**: 最終確認後、style.gsファイルを更新

## 解析対象要素

### 変更対象
- **COLORS**: カラーパレット（primary_blue, text_primary, background等）
- **LOGOS**: ヘッダー・クロージング用ロゴURL
- **FOOTER_TEXT**: カスタマイズされたフッター内容

### 変更対象外（既存値維持）
- **POS_PX**: レイアウト位置設定
- **FONTS**: フォント設定（family, sizes）

## 重要な制約
- **絶対禁止**: style.gs以外のファイルの変更
- **必須**: PDF解析→提案→確認→実装の段階的プロセス
- **品質**: エラーのない完璧なCOLORS、LOGOS、FOOTER_TEXT設定の生成

まず「PDFテンプレートファイルをアップロードしてください」と問いかけて開始してください。
```

## 使用方法

### スライド生成の場合
1. `Cmd/Ctrl + Shift + S` でSlide Generatorモードに切り替え
2. チャットで議事録や企画書などの情報を提供
3. AIが構成を提案するので確認・調整
4. 最終確認後、`src/text-data.gs`が自動更新される

### スタイル更新の場合
1. `Cmd/Ctrl + Shift + T` でStyle Updaterモードに切り替え
2. PDFテンプレートファイルをアップロード
3. AIがデザイン要素を解析・提案
4. 確認後、`src/style.gs`が自動更新される

## 注意事項

- 各モードは特定のタスクに特化しているため、適切なモードを選択してください
- ファイル更新後は必ず `build.sh` を実行してGAS用ファイルを生成してください
- 設定に問題がある場合は、`.cursorrules`ファイルを参照してください

## トラブルシューティング

### カスタムモードが表示されない
- Cursor設定でCustom modes機能が有効になっているか確認
- Cursorを再起動してみる

### AIが適切に動作しない
- Custom Instructionsの内容を再確認
- モード切り替えが正しく行われているか確認

この設定により、`.claude/commands`と同様の専門的なAIアシスタント機能をCursorでも利用できるようになります。
